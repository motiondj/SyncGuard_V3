# SyncGuard 외부 데이터 전송 기능 명세서

## 📋 개요

SyncGuard는 NVIDIA Quadro Sync 상태를 외부 시스템(CMS, 모니터링 시스템 등)에 실시간으로 전송하는 기능을 제공합니다. 이를 통해 외부 프로그램에서 동기화 상태를 확인하고, 사용자가 수동으로 복구 작업을 수행할 수 있습니다.

## 🎯 목적

- 외부 CMS에서 동기화 상태 실시간 확인
- 동기화 문제 발생 시 즉시 알림
- 사용자의 수동 복구 작업 지원
- 네트워크 기반 분산 모니터링 시스템 구축

## 🔧 기술 명세

### 통신 방식
- **프로토콜**: TCP 소켓 통신
- **방향**: SyncGuard → 외부 시스템 (단방향 전송)
- **폴링 방식**: 외부 시스템에서 주기적 요청 (5-10초 간격 권장)

### 데이터 형식
```
요청: "GET_STATUS"
응답: "Synced" 또는 "Free"
```

### 상태 정의
- **Synced**: 동기화 정상 (Locked 상태)
- **Free**: 동기화 안됨 (UnSynced, Slave 등 모든 비정상 상태)

## ⚙️ 설정 방식

### 트레이 메뉴 설정 (추천)
- 트레이 아이콘 우클릭 → "설정" 메뉴
- 설정 창에서 다음 항목 구성:
  - 대상 IP 주소 입력
  - 포트 번호 입력 (기본값: 8080)
  - 외부 전송 활성화 체크박스
  - 연결 테스트 버튼
  - 저장/취소 버튼

### 메뉴 구조
```
SyncGuard
├── 현재 상태: Synced/Free
├── 설정...
├── 리프레시
└── 종료
```

## 🔌 연결 설정

### 기본 설정
- **포트**: 8080 (설정 가능)
- **프로토콜**: TCP
- **인코딩**: UTF-8
- **타임아웃**: 5초

### 설정 파일 (백업)
- 파일명: `syncguard_config.txt`
- 위치: SyncGuard 실행 디렉토리
- 형식:
```
# SyncGuard 외부 전송 설정
TARGET_IP=192.168.1.100
TARGET_PORT=8080
ENABLE_EXTERNAL_SEND=true
```

## 📡 통신 프로토콜

### 연결 과정
1. 외부 시스템이 SyncGuard에 TCP 연결
2. 외부 시스템이 "GET_STATUS" 요청 전송
3. SyncGuard가 현재 상태 응답 ("Synced" 또는 "Free")
4. 연결 유지 (다음 요청 대기)

### 에러 처리
- 연결 실패 시 로그 기록
- 재연결 시도 (30초 간격)
- 외부 시스템 연결 상태 모니터링

## 📊 로그 및 모니터링

### 로그 항목
- 외부 연결 시도/성공/실패
- 데이터 전송 성공/실패
- 연결 상태 변경
- 설정 변경 이력

### 로그 예시
```
[2025-06-26 10:30:00] [INFO] 외부 전송 설정 로드: 192.168.1.100:8080
[2025-06-26 10:30:01] [INFO] 외부 시스템 연결 성공
[2025-06-26 10:30:05] [INFO] 상태 전송: Synced
[2025-06-26 10:30:15] [INFO] 상태 전송: Synced
```

## 🔄 동작 흐름

### 1. 초기화
1. SyncGuard 시작
2. 설정 파일 로드
3. 외부 전송 기능 초기화
4. TCP 서버 시작

### 2. 상태 모니터링
1. WMI를 통한 동기화 상태 감지 (1초 간격)
2. 상태 변경 시 로그 기록
3. 트레이 아이콘 업데이트

### 3. 외부 전송
1. 외부 시스템 연결 대기
2. "GET_STATUS" 요청 수신
3. 현재 상태 응답 전송
4. 연결 유지

## 📋 구현 체크리스트

### 핵심 기능
- [ ] TCP 서버 구현
- [ ] 설정 창 UI 구현
- [ ] 상태 변환 로직 (Locked → Synced, 기타 → Free)
- [ ] 연결 관리 (다중 클라이언트 지원)
- [ ] 에러 처리 및 재연결

### UI/UX
- [ ] 트레이 메뉴에 "설정" 추가
- [ ] 설정 창 디자인
- [ ] 연결 상태 표시
- [ ] 설정 저장/로드

### 로깅
- [ ] 외부 연결 로그
- [ ] 데이터 전송 로그
- [ ] 설정 변경 로그
- [ ] 에러 로그

## 🎯 사용 시나리오

### 시나리오 1: 정상 동작
1. SyncGuard가 "Locked" 상태 감지
2. 외부 시스템이 "GET_STATUS" 요청
3. SyncGuard가 "Synced" 응답
4. 외부 CMS에서 녹색 상태 표시

### 시나리오 2: 동기화 문제
1. SyncGuard가 "UnSynced" 상태 감지
2. 외부 시스템이 "GET_STATUS" 요청
3. SyncGuard가 "Free" 응답
4. 외부 CMS에서 빨간색 경고 표시
5. 사용자가 수동으로 복구 작업 수행

## 📈 성능 고려사항

### 리소스 사용량
- TCP 서버: 최소 메모리 사용
- 네트워크: 매우 낮은 대역폭 (텍스트 기반)
- CPU: 거의 사용하지 않음

### 확장성
- 다중 클라이언트 동시 연결 지원
- 설정 변경 시 즉시 적용
- 로그 로테이션으로 디스크 공간 관리

## 🔮 향후 확장 계획

### 가능한 추가 기능
- 실시간 알림 (상태 변경 시 즉시 전송)
- 상세 상태 정보 (에러 코드, 시스템 정보)
- 웹 인터페이스 (브라우저에서 상태 확인)

### 기술적 개선
- HTTP API 서버로 확장
- JSON 형식 데이터 전송
- RESTful API 구현

---

**문서 버전**: 1.0  
**작성일**: 2025-06-26  
**작성자**: SyncGuard 개발팀  
**상태**: 최종 명세서 